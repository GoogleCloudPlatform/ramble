<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3) Modifying A GROMACS Experiment &mdash; Ramble 0.3.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=e259d695"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4) Using Vectors and Matrices" href="4_using_vectors_and_matrices.html" />
    <link rel="prev" title="2) Running A Simple GROMACS Experiment" href="2_running_a_simple_gromacs_experiment.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
          </a>
              <div class="version">
                0.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_hello_world.html">1) Getting Started Running A “Hello World” Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_running_a_simple_gromacs_experiment.html">2) Running A Simple GROMACS Experiment</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3) Modifying A GROMACS Experiment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuring-experiments">Configuring experiments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#create-and-activate-a-workspace">Create and Activate a Workspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configure-the-workspace">Configure the Workspace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#experiment-descriptions">Experiment Descriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-workload-variables">Using Workload Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#editing-experiments">Editing Experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#execute-experiments">Execute Experiments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="4_using_vectors_and_matrices.html">4) Using Vectors and Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_changing_your_software_stack.html">5) Changing A Software Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_configuring_a_scaling_study.html">6) Configuring a Scaling Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_using_zips_and_matrices.html">7) Zips and Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="8_var_expansion_indirection_and_stack_parameterization.html">8) Variable Expansion, Indirection, and Software Stack Parameterization</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_success_criteria.html">9) Success Criteria</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_using_modifiers.html">10) Modifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_using_internals.html">11) Internals</a></li>
<li class="toctree-l2"><a class="reference internal" href="mirrors.html">Mirrors</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ramble.html">ramble package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_files.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workspace.html">Ramble Workspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workspace_config.html">Workspace Configuration File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../success_criteria.html">Success Criteria</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/GoogleCloudPlatform/ramble#contributing">Contributing Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guides.html">Developer Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/spack/spack">Spack</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ramble</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">3) Modifying A GROMACS Experiment</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/3_modifying_a_gromacs_experiment.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="modifying-a-gromacs-experiment">
<span id="modifying-an-experiment-tutorial"></span><h1>3) Modifying A GROMACS Experiment<a class="headerlink" href="#modifying-a-gromacs-experiment" title="Link to this heading"></a></h1>
<p>In this tutorial, you will learn how to modify an existing workspace
configuration that contains experiments using
<a class="reference external" href="https://www.gromacs.org/">GROMACS</a>, a free and open-source application
for molecular dynamics.</p>
<p>This tutorial builds off of concepts introduced in previous tutorials. Please
make sure you review those before starting with this tutorial’s content.</p>
<section id="configuring-experiments">
<h2>Configuring experiments<a class="headerlink" href="#configuring-experiments" title="Link to this heading"></a></h2>
<p>For this tutorial, you are going to focus on creating experiments from the
<code class="docutils literal notranslate"><span class="pre">water_bare</span></code> and <code class="docutils literal notranslate"><span class="pre">water_gmx50</span></code> workloads. The default configuration will
contain experiments for each value of the <code class="docutils literal notranslate"><span class="pre">type</span></code> variable, and a single value
for the <code class="docutils literal notranslate"><span class="pre">size</span></code> variable.</p>
<p>You will use a Ramble workspace to manage these experiments.</p>
<section id="create-and-activate-a-workspace">
<h3>Create and Activate a Workspace<a class="headerlink" href="#create-and-activate-a-workspace" title="Link to this heading"></a></h3>
<p>Before you can configure your GROMACS experiments, you’ll need to set up a
workspace. You can call this workspace <code class="docutils literal notranslate"><span class="pre">basic_gromacs</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ramble<span class="w"> </span>workspace<span class="w"> </span>create<span class="w"> </span>basic_gromacs
</pre></div>
</div>
<p>This will create a workspace for you in:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">$ramble_root</span>/var/ramble/workspaces/basic_gromacs
</pre></div>
</div>
<p>Now you can activate the workspace and view its default configuration.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ramble<span class="w"> </span>workspace<span class="w"> </span>activate<span class="w"> </span>basic_gromacs
<span class="gp">$ </span>ramble<span class="w"> </span>workspace<span class="w"> </span>info
</pre></div>
</div>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">ramble</span> <span class="pre">workspace</span> <span class="pre">info</span></code> command after editing configuration
files to see how ramble would use the changes you made.</p>
</section>
<section id="configure-the-workspace">
<h3>Configure the Workspace<a class="headerlink" href="#configure-the-workspace" title="Link to this heading"></a></h3>
<p>Within the workspace directory, ramble creates a directory named <code class="docutils literal notranslate"><span class="pre">configs</span></code>.
This directory contains generated configuration and template files. Each of
these files can be edited to configure the workspace, and examples will be
provided below.</p>
<p>The available files are:
* <code class="docutils literal notranslate"><span class="pre">ramble.yaml</span></code> This file describes all aspects of the workspace. This
includes the software stack, the experiments, and all variables.
* <code class="docutils literal notranslate"><span class="pre">execute_experiment.tpl</span></code> This file is a template shell script that will be
rendered to execute each of the experiments that ramble generates.</p>
<p>You can edit these files directly or with the command <code class="docutils literal notranslate"><span class="pre">ramble</span> <span class="pre">workspace</span> <span class="pre">edit</span></code>.</p>
<p>To begin, you should edit the <code class="docutils literal notranslate"><span class="pre">ramble.yaml</span></code> file to set up the configuration
for your experiments. For this tutorial, replace the default yaml text with the
contents of <code class="docutils literal notranslate"><span class="pre">$ramble_root/examples/basic_gromacs_config.yaml</span></code>:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nt">ramble</span><span class="p">:</span>
<span class="linenos"> 2</span><span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}</span><span class="nv"> </span><span class="s">-ppn</span><span class="nv"> </span><span class="s">{processes_per_node}&#39;</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="linenos"> 6</span><span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="nt">gromacs</span><span class="p">:</span><span class="w"> </span><span class="c1"># Application name</span>
<span class="linenos"> 8</span><span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="linenos"> 9</span><span class="w">        </span><span class="nt">water_gmx50</span><span class="p">:</span><span class="w"> </span><span class="c1"># Workload name from application</span>
<span class="linenos">10</span><span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="linenos">11</span><span class="w">            </span><span class="nt">pme_single_rank</span><span class="p">:</span><span class="w"> </span><span class="c1"># Arbitrary experiment name</span>
<span class="linenos">12</span><span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">13</span><span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">14</span><span class="w">                </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">15</span><span class="w">                </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0003&#39;</span>
<span class="linenos">16</span><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;pme&#39;</span>
<span class="linenos">17</span><span class="w">            </span><span class="nt">rf_single_rank</span><span class="p">:</span>
<span class="linenos">18</span><span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">19</span><span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">20</span><span class="w">                </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">21</span><span class="w">                </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0003&#39;</span>
<span class="linenos">22</span><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;rf&#39;</span>
<span class="linenos">23</span><span class="w">        </span><span class="nt">water_bare</span><span class="p">:</span>
<span class="linenos">24</span><span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="linenos">25</span><span class="w">            </span><span class="nt">pme_single_rank</span><span class="p">:</span>
<span class="linenos">26</span><span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">27</span><span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">28</span><span class="w">                </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">29</span><span class="w">                </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0003&#39;</span>
<span class="linenos">30</span><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;pme&#39;</span>
<span class="linenos">31</span><span class="w">            </span><span class="nt">rf_single_rank</span><span class="p">:</span>
<span class="linenos">32</span><span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">33</span><span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">34</span><span class="w">                </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">35</span><span class="w">                </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0003&#39;</span>
<span class="linenos">36</span><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;rf&#39;</span>
<span class="linenos">37</span><span class="w">  </span><span class="nt">spack</span><span class="p">:</span>
<span class="linenos">38</span><span class="w">    </span><span class="nt">concretized</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="linenos">39</span><span class="w">    </span><span class="nt">packages</span><span class="p">:</span>
<span class="linenos">40</span><span class="w">      </span><span class="nt">gcc9</span><span class="p">:</span>
<span class="linenos">41</span><span class="w">        </span><span class="nt">spack_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc@9.3.0 target=x86_64</span>
<span class="linenos">42</span><span class="w">        </span><span class="nt">compiler_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc@9.3.0</span>
<span class="linenos">43</span><span class="w">      </span><span class="nt">impi2018</span><span class="p">:</span>
<span class="linenos">44</span><span class="w">        </span><span class="nt">spack_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">intel-mpi@2018.4.274 target=x86_64</span>
<span class="linenos">45</span><span class="w">        </span><span class="nt">compiler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc9</span>
<span class="linenos">46</span><span class="w">      </span><span class="nt">gromacs</span><span class="p">:</span>
<span class="linenos">47</span><span class="w">        </span><span class="nt">spack_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gromacs@2021.6</span>
<span class="linenos">48</span><span class="w">        </span><span class="nt">compiler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc9</span>
<span class="linenos">49</span><span class="w">    </span><span class="nt">environments</span><span class="p">:</span>
<span class="linenos">50</span><span class="w">      </span><span class="nt">gromacs</span><span class="p">:</span>
<span class="linenos">51</span><span class="w">        </span><span class="nt">packages</span><span class="p">:</span>
<span class="linenos">52</span><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gromacs</span>
<span class="linenos">53</span><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">impi2018</span>
</pre></div>
</div>
<p>Note that specifying compilers that Spack doesn’t have installed may take a while.
To see available compilers, use <code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">compilers</span></code> or see <a class="reference external" href="https://spack.readthedocs.io/en/latest/getting_started.html#spack-compilers">Spack documentation</a>
for more information.</p>
<p>The second file you should edit is the <code class="docutils literal notranslate"><span class="pre">execute_experiment.tpl</span></code> template file.
This file contains a template script that will be rendered into an execution
script for each generated experiment. You can feel free to edit it as you need
to for your given system, but for this tutorial the default value will work.</p>
</section>
</section>
<section id="experiment-descriptions">
<h2>Experiment Descriptions<a class="headerlink" href="#experiment-descriptions" title="Link to this heading"></a></h2>
<p>Now that your workspace has been configured, and activated, You can execute the
following command to see what experiments the workspace currently contains:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ramble<span class="w"> </span>workspace<span class="w"> </span>info
</pre></div>
</div>
<p>This command provides a summary view of the workspace. It includes the
experiment names, and the software environments. As an example, its output
might contain the following information:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Experiments:</span>
<span class="go">  Application: gromacs</span>
<span class="go">    Workload: water_gmx50</span>
<span class="go">      Experiment: gromacs.water_gmx50.pme_single_rank</span>
<span class="go">  Application: gromacs</span>
<span class="go">    Workload: water_gmx50</span>
<span class="go">      Experiment: gromacs.water_gmx50.rf_single_rank</span>
<span class="go">  Application: gromacs</span>
<span class="go">    Workload: water_bare</span>
<span class="go">      Experiment: gromacs.water_bare.pme_single_rank</span>
<span class="go">  Application: gromacs</span>
<span class="go">    Workload: water_bare</span>
<span class="go">      Experiment: gromacs.water_bare.rf_single_rank</span>
</pre></div>
</div>
<p>To get detailed information about where variable definitions come from, you can use:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ramble<span class="w"> </span>workspace<span class="w"> </span>info<span class="w"> </span>-v
</pre></div>
</div>
<p>The experiments section of this command’s output might contain the following:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Experiments:</span>
<span class="go">  Application: gromacs</span>
<span class="go">    Workload: water_gmx50</span>
<span class="go">      Experiment: gromacs.water_gmx50.pme_single_rank</span>
<span class="go">        Variables from Workspace:</span>
<span class="go">          processes_per_node = 16 ==&gt; 16</span>
<span class="go">          mpi_command = mpirun -n {n_ranks} -ppn {processes_per_node} ==&gt; mpirun -n 1 -ppn 16</span>
<span class="go">          batch_submit = {execute_experiment} ==&gt; {execute_experiment}</span>
<span class="go">        Variables from Experiment:</span>
<span class="go">          n_ranks = 1 ==&gt; 1</span>
<span class="go">          n_threads = 1 ==&gt; 1</span>
<span class="go">          size = 0003 ==&gt; 0003</span>
<span class="go">          type = pme ==&gt; pme</span>
<span class="go">  Application: gromacs</span>
<span class="go">    Workload: water_gmx50</span>
<span class="go">      Experiment: gromacs.water_gmx50.rf_single_rank</span>
<span class="go">        Variables from Workspace:</span>
<span class="go">          processes_per_node = 16 ==&gt; 16</span>
<span class="go">          mpi_command = mpirun -n {n_ranks} -ppn {processes_per_node} ==&gt; mpirun -n 1 -ppn 16</span>
<span class="go">          batch_submit = {execute_experiment} ==&gt; {execute_experiment}</span>
<span class="go">        Variables from Experiment:</span>
<span class="go">          n_ranks = 1 ==&gt; 1</span>
<span class="go">          n_threads = 1 ==&gt; 1</span>
<span class="go">          size = 0003 ==&gt; 0003</span>
<span class="go">          type = rf ==&gt; rf</span>
<span class="go">  Application: gromacs</span>
<span class="go">    Workload: water_bare</span>
<span class="go">      Experiment: gromacs.water_bare.pme_single_rank</span>
<span class="go">        Variables from Workspace:</span>
<span class="go">          processes_per_node = 16 ==&gt; 16</span>
<span class="go">          mpi_command = mpirun -n {n_ranks} -ppn {processes_per_node} ==&gt; mpirun -n 1 -ppn 16</span>
<span class="go">          batch_submit = {execute_experiment} ==&gt; {execute_experiment}</span>
<span class="go">        Variables from Experiment:</span>
<span class="go">          n_ranks = 1 ==&gt; 1</span>
<span class="go">          n_threads = 1 ==&gt; 1</span>
<span class="go">          size = 0003 ==&gt; 0003</span>
<span class="go">          type = pme ==&gt; pme</span>
<span class="go">  Application: gromacs</span>
<span class="go">    Workload: water_bare</span>
<span class="go">      Experiment: gromacs.water_bare.rf_single_rank</span>
<span class="go">        Variables from Workspace:</span>
<span class="go">          processes_per_node = 16 ==&gt; 16</span>
<span class="go">          mpi_command = mpirun -n {n_ranks} -ppn {processes_per_node} ==&gt; mpirun -n 1 -ppn 16</span>
<span class="go">          batch_submit = {execute_experiment} ==&gt; {execute_experiment}</span>
<span class="go">        Variables from Experiment:</span>
<span class="go">          n_ranks = 1 ==&gt; 1</span>
<span class="go">          n_threads = 1 ==&gt; 1</span>
<span class="go">          size = 0003 ==&gt; 0003</span>
<span class="go">          type = rf ==&gt; rf</span>
</pre></div>
</div>
<p>The variables <code class="docutils literal notranslate"><span class="pre">mpi_command</span></code>, <code class="docutils literal notranslate"><span class="pre">processes_per_node</span></code>, and <code class="docutils literal notranslate"><span class="pre">batch_submit</span></code>
come from the workspace scope on lines 3, 4, and 5 of the YAML file in
<span class="xref std std-ref">gromacs_workspace_config</span>. Each experiment has its own definition for
<code class="docutils literal notranslate"><span class="pre">n_ranks</span></code>, <code class="docutils literal notranslate"><span class="pre">n_threads</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code>, and <code class="docutils literal notranslate"><span class="pre">type</span></code>.</p>
<p>The experiments in this configuration use both the <code class="docutils literal notranslate"><span class="pre">water_bare</span></code> and
<code class="docutils literal notranslate"><span class="pre">water_gmx50</span></code> workloads.</p>
</section>
<section id="using-workload-variables">
<h2>Using Workload Variables<a class="headerlink" href="#using-workload-variables" title="Link to this heading"></a></h2>
<p>Application definitions are allowed to expose variables that can be used within
experiments. These are called <strong>workload variables</strong>. User can view the
available variables with the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ramble<span class="w"> </span>info<span class="w"> </span>gromacs
</pre></div>
</div>
<p>Focusing on the relevant workloads, you see the following information:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Workload: water_gmx50</span>
<span class="go">    Executables: [&#39;builtin::env_vars&#39;, &#39;builtin::spack_source&#39;, &#39;builtin::spack_activate&#39;, &#39;pre-process&#39;, &#39;execute-gen&#39;]</span>
<span class="go">    Inputs: [&#39;water_gmx50_bare&#39;]</span>
<span class="go">    Variables:</span>
<span class="go">        size:</span>
<span class="go">            Description: Workload size</span>
<span class="go">            Default: 1536</span>
<span class="go">            Suggested Values: [&#39;0000.65&#39;, &#39;0000.96&#39;, &#39;0001.5&#39;, &#39;0003&#39;, &#39;0006&#39;, &#39;0012&#39;, &#39;0024&#39;, &#39;0048&#39;, &#39;0096&#39;, &#39;0192&#39;, &#39;0384&#39;, &#39;0768&#39;, &#39;1536&#39;, &#39;3072&#39;]</span>
<span class="go">        type:</span>
<span class="go">            Description: Workload type.</span>
<span class="go">            Default: pme</span>
<span class="go">            Suggested Values: [&#39;pme&#39;, &#39;rf&#39;]</span>
<span class="go">        input_path:</span>
<span class="go">            Description: Input path for water GMX50</span>
<span class="go">            Default: {water_gmx50_bare}/{size}</span>
<span class="go">Workload: water_bare</span>
<span class="go">    Executables: [&#39;builtin::env_vars&#39;, &#39;builtin::spack_source&#39;, &#39;builtin::spack_activate&#39;, &#39;pre-process&#39;, &#39;execute-gen&#39;]</span>
<span class="go">    Inputs: [&#39;water_bare_hbonds&#39;]</span>
<span class="go">    Variables:</span>
<span class="go">        size:</span>
<span class="go">            Description: Workload size</span>
<span class="go">            Default: 1536</span>
<span class="go">            Suggested Values: [&#39;0000.65&#39;, &#39;0000.96&#39;, &#39;0001.5&#39;, &#39;0003&#39;, &#39;0006&#39;, &#39;0012&#39;, &#39;0024&#39;, &#39;0048&#39;, &#39;0096&#39;, &#39;0192&#39;, &#39;0384&#39;, &#39;0768&#39;, &#39;1536&#39;, &#39;3072&#39;]</span>
<span class="go">        type:</span>
<span class="go">            Description: Workload type.</span>
<span class="go">            Default: pme</span>
<span class="go">            Suggested Values: [&#39;pme&#39;, &#39;rf&#39;]</span>
<span class="go">        input_path:</span>
<span class="go">            Description: Input path for water bare hbonds</span>
<span class="go">            Default: {water_bare_hbonds}/{size}</span>
</pre></div>
</div>
<p>Within each of the workloads your workspace has experiments for, you can see
definitions for both <code class="docutils literal notranslate"><span class="pre">size</span></code> and <code class="docutils literal notranslate"><span class="pre">type</span></code>. The <code class="docutils literal notranslate"><span class="pre">Suggested</span> <span class="pre">Values</span></code> attribute
defines possible values for each of the variables, which can be defined within
your workspace’s <code class="docutils literal notranslate"><span class="pre">ramble.yaml</span></code> file.</p>
<p>While these variables contain <code class="docutils literal notranslate"><span class="pre">Suggested</span> <span class="pre">Values</span></code> some other variable
definitions can take any value you want. As a result, they might not provide
anything other than a default value. While the default value is expected to
function properly, you as the user can override their definition within the
<code class="docutils literal notranslate"><span class="pre">ramble.yaml</span></code> if your experiments would benefit from it. However, be aware
that this also has the potential to change the behavior of your experiments and
is considered an advanced action.</p>
</section>
<section id="editing-experiments">
<h2>Editing Experiments<a class="headerlink" href="#editing-experiments" title="Link to this heading"></a></h2>
<p>Now that you know how to determine which values are possible, select one or
more of the possible values for the <code class="docutils literal notranslate"><span class="pre">size</span></code> variable. You will modify the
experiments in your workspace to use this (remember, you have 4 experiments
defined currently). <strong>NOTE</strong> The larger the value, the more expensive the
experiment will be. However you can give each experiment a unique value.</p>
<p>To make editing the workspace easier, use the following command (assuming you
have an <code class="docutils literal notranslate"><span class="pre">EDITOR</span></code> environment variable set):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ramble<span class="w"> </span>workspace<span class="w"> </span>edit
</pre></div>
</div>
<p>This command opens the <code class="docutils literal notranslate"><span class="pre">ramble.yaml</span></code> file, along with any <code class="docutils literal notranslate"><span class="pre">*.tpl</span></code> files in
the workspace’s <code class="docutils literal notranslate"><span class="pre">configs</span></code> directory. The root directory of the workspace can
be seen in the <code class="docutils literal notranslate"><span class="pre">Location</span></code> attribute output from:</p>
<p>When the <code class="docutils literal notranslate"><span class="pre">ramble.yaml</span></code> is open, modify any of the experiment’s <code class="docutils literal notranslate"><span class="pre">size</span></code>
variable definitions that you want to. Finally, save and exit the file.</p>
<p>These changes should now be reflected in the output of:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ramble<span class="w"> </span>workspace<span class="w"> </span>info<span class="w"> </span>-v
</pre></div>
</div>
</section>
<section id="execute-experiments">
<h2>Execute Experiments<a class="headerlink" href="#execute-experiments" title="Link to this heading"></a></h2>
<p>Now that you have made the appropriate modifications, set up, execute, and
analyze the new experiments using:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ramble<span class="w"> </span>workspace<span class="w"> </span>setup
<span class="gp">$ </span>ramble<span class="w"> </span>on
<span class="gp">$ </span>ramble<span class="w"> </span>workspace<span class="w"> </span>analyze
</pre></div>
</div>
<p>This creates a <code class="docutils literal notranslate"><span class="pre">results</span></code> file in the root of the workspace that contains
extracted figures of merit. If the experiments were successful, this file will
show the following results:</p>
<ul class="simple">
<li><p>Core Time: CPU time (in seconds) spent on the benchmark calculations</p></li>
<li><p>Wall Time: Elapsed real time (in seconds) spent on the benchmark calculations</p></li>
<li><p>Percent Core Time: Core Time / Wall Time</p></li>
<li><p>Nanosecs per day: Nanoseconds of simulation per day at the speed achieved</p></li>
<li><p>Hours per nanosec: Hours required to calculate 1 nanosecond of simulation at
the speed achieved</p></li>
</ul>
<p>If you have a <code class="docutils literal notranslate"><span class="pre">results</span></code> file from the <a class="reference internal" href="2_running_a_simple_gromacs_experiment.html#running-an-experiment-tutorial"><span class="std std-ref">2) Running A Simple GROMACS Experiment</span></a>,
you can compare it with the newly created results file to see what impact
changing the <code class="docutils literal notranslate"><span class="pre">size</span></code> variable had on your figures of merit.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="2_running_a_simple_gromacs_experiment.html" class="btn btn-neutral float-left" title="2) Running A Simple GROMACS Experiment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="4_using_vectors_and_matrices.html" class="btn btn-neutral float-right" title="4) Using Vectors and Matrices" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Google LLC.
      <span class="lastupdated">Last updated on Dec 06, 2023.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>