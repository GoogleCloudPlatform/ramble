<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Workspace Configuration File &mdash; Ramble 0.5.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=1dd76d02"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=932ab54e"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Success Criteria" href="success_criteria.html" />
    <link rel="prev" title="Ramble Workspace" href="workspace.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
          </a>
              <div class="version">
                0.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ramble.html">ramble package</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration_files.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="workspace.html">Ramble Workspace</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Workspace Configuration File</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ramble-dictionary">Ramble Dictionary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#experiment-names">Experiment Names</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variable-dictionaries">Variable Dictionaries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#supported-functions">Supported Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#escaped-variables">Escaped Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#list-or-vector-variables">List (or Vector) Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variable-matrices">Variable Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#explicit-variable-zips">Explicit Variable Zips</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variant-control">Variant Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#experiment-exclusion">Experiment Exclusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#experiment-repeats">Experiment Repeats</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environment-variable-control">Environment Variable Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#templatized-workloads">Templatized Workloads</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cross-experiment-variable-references">Cross Experiment Variable References</a></li>
<li class="toctree-l3"><a class="reference internal" href="#experiment-modifiers">Experiment Modifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#experiment-tags">Experiment Tags</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controlling-internals">Controlling Internals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reserved-variables">Reserved Variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#software-dictionary">Software Dictionary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#controlling-mpi-libraries-and-batch-systems">Controlling MPI Libraries and Batch Systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mpi-command-control">MPI Command Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batch-system-control">Batch System Control</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#experiment-chains">Experiment Chains</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#defining-experiment-chains">Defining Experiment Chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="#suppressing-experiments">Suppressing Experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variable-inheritance">Variable Inheritance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-chains-of-chains">Defining Chains of Chains</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="success_criteria.html">Success Criteria</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/GoogleCloudPlatform/ramble#contributing">Contributing Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_guides.html">Developer Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/spack/spack">Spack</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ramble</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Workspace Configuration File</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/workspace_config.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="workspace-configuration-file">
<span id="workspace-config"></span><h1>Workspace Configuration File<a class="headerlink" href="#workspace-configuration-file" title="Link to this heading"></a></h1>
<p>Ramble workspaces are controlled through their configuration files. Each
workspace has a configuration file stored at <code class="docutils literal notranslate"><span class="pre">$workspace/configs/ramble.yaml</span></code>.</p>
<p>This document will describe the syntax for writing a workspace configuration file.</p>
<p>Within the <code class="docutils literal notranslate"><span class="pre">ramble.yaml</span></code> file, all content lives under the top level <code class="docutils literal notranslate"><span class="pre">ramble</span></code> dictionary:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ramble:</span>
<span class="go">  ...</span>
</pre></div>
</div>
<p>This dictionary is used to control all of the aspects of the Ramble workspace.</p>
<section id="ramble-dictionary">
<h2>Ramble Dictionary<a class="headerlink" href="#ramble-dictionary" title="Link to this heading"></a></h2>
<p>The ramble dictionary is used to control the experiments a workspace is
responsible for configuring, executing, analyzing, and archiving.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="nt">test_exp</span><span class="p">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">                </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
</pre></div>
</div>
<p>Within a ramble configuration file, configuration scopes for an experiment
include, <code class="docutils literal notranslate"><span class="pre">application</span></code>, <code class="docutils literal notranslate"><span class="pre">workload</span></code>, and <code class="docutils literal notranslate"><span class="pre">experiment</span></code>. They are denoted by
these words in the configuration file. The name <code class="docutils literal notranslate"><span class="pre">hostname</span></code> name of the ramble
application (as seen by <code class="docutils literal notranslate"><span class="pre">ramble</span> <span class="pre">list</span></code>), while the name <code class="docutils literal notranslate"><span class="pre">serial</span></code> is the name of the
workload (as seen by <code class="docutils literal notranslate"><span class="pre">ramble</span> <span class="pre">info</span> <span class="pre">hostname</span></code>).</p>
<p>The name <code class="docutils literal notranslate"><span class="pre">test_exp</span></code> is user defined, and will be explained in <a class="reference internal" href="#experiment-names"><span class="std std-ref">Experiment Names</span></a>.</p>
<p>The name <code class="docutils literal notranslate"><span class="pre">variables</span></code> defines arbitrary variables, and will be explained in
<a class="reference internal" href="#variable-dictionaries"><span class="std std-ref">Variable Dictionaries</span></a>.</p>
<section id="experiment-names">
<span id="id1"></span><h3>Experiment Names<a class="headerlink" href="#experiment-names" title="Link to this heading"></a></h3>
<p>While the names of applications and workloads are defined by the application
definition file, experiment names are more arbitrary. Experiment names are
string, and can take variables for expansion.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">test_{n_ranks}_{n_nodes}</span><span class="p p-Indicator">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">                </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">                </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
</pre></div>
</div>
<p>In the above example, the experiment name would be: <code class="docutils literal notranslate"><span class="pre">test_1_1</span></code> when it is created.</p>
<p><strong>NOTE:</strong> Each experiment has a namespace that follows this pattern:
<code class="docutils literal notranslate"><span class="pre">application.workload.experiment</span></code>. Every experiment needs a unique namespace,
or ramble will throw an error.</p>
</section>
<section id="variable-dictionaries">
<span id="id2"></span><h3>Variable Dictionaries<a class="headerlink" href="#variable-dictionaries" title="Link to this heading"></a></h3>
<p>Within a variable dictionary, arbitrary variables can be defined. Defined
variables apply to all experiments within their scope.</p>
<p>These variables can be referred to within the YAML file, or template files
using python keyword ( <code class="docutils literal notranslate"><span class="pre">{var_name}</span></code> ) syntax to perform variable expansion.</p>
<p>If a variable is defined within multiple dictionaries, values defined closer to
individual experiments take precedence.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">    </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;16&#39;</span>
<span class="w">    </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">        </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">            </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="nt">test_exp</span><span class="p">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">n_ranks</span></code> will take a value of <code class="docutils literal notranslate"><span class="pre">1</span></code> within the <code class="docutils literal notranslate"><span class="pre">test_exp</span></code>
experiment. This experiment will also include definitions for
<code class="docutils literal notranslate"><span class="pre">processes_per_node</span></code>, <code class="docutils literal notranslate"><span class="pre">n_nodes</span></code>, and <code class="docutils literal notranslate"><span class="pre">n_threads</span></code>.</p>
<section id="supported-functions">
<span id="ramble-supported-functions"></span><h4>Supported Functions<a class="headerlink" href="#supported-functions" title="Link to this heading"></a></h4>
<p>Ramble’s variable expansion logic supports several mathematical operators and
functions to help construct useful variable definitions.</p>
<p>Supported math operators are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">+</span></code> (addition)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-</span></code> (subtraction)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*</span></code> (multiplication)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/</span></code> (division)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">//</span></code> (floor division)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**</span></code> (exponent)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">^</span></code> (bitwise exclusive or)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-</span></code> (unary subtraction)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">==</span></code> (equal)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">!=</span></code> (not equal)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;</span></code> (greater than)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> (greator or equal than)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;</span></code> (less than)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;=</span></code> (less or equal than)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">and</span></code> (logical and)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">or</span></code> (logical or)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%</span></code> (modulo)</p></li>
</ul>
<p>Supported functions are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">str()</span></code> (explicit string cast)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int()</span></code> (explicit integer cast)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float()</span></code> (explicit float cast)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min()</span></code> (minimum)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max()</span></code> (maximum)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ceil()</span></code> (ceiling of input)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">floor()</span></code> (floor of input)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">range()</span></code> (construct range, see <a class="reference internal" href="#ramble-vector-logic"><span class="std std-ref">ramble vector logic</span></a> for more information)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simplify_str()</span></code> (convert input string to only alphanumerical characters and dashes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">randrange</span></code> (from <cite>random.randrange</cite>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">randint</span></code> (from <cite>random.randint</cite>)</p></li>
</ul>
</section>
<section id="escaped-variables">
<span id="ramble-escaped-variables"></span><h4>Escaped Variables<a class="headerlink" href="#escaped-variables" title="Link to this heading"></a></h4>
<p>When referring to variables in Ramble, sometimes it is useful to be able to
escape curly braces to prevent the expander from fully expanding the variable
reference. Curly braces that are prefixed with a back slash (i.e. <code class="docutils literal notranslate"><span class="pre">\{</span></code> or
<code class="docutils literal notranslate"><span class="pre">\}</span></code>) will be replaced with an unexpanded curly brace by Ramble’s expander.</p>
<p>Each time the variable is expanded, the escaped curly braces will be replaced
with unescaped curly braces (i.e. <code class="docutils literal notranslate"><span class="pre">\{</span></code> will expand to <code class="docutils literal notranslate"><span class="pre">{</span></code>). Additional back
slashes can be added to prevent multiple expansions (i.e. <code class="docutils literal notranslate"><span class="pre">\\{</span></code> will expand
to <code class="docutils literal notranslate"><span class="pre">\{</span></code>).</p>
</section>
</section>
<section id="list-or-vector-variables">
<span id="ramble-vector-logic"></span><h3>List (or Vector) Variables<a class="headerlink" href="#list-or-vector-variables" title="Link to this heading"></a></h3>
<p>Variables can be defined as a list of values as well (again, following the same
math and variable expansion syntax as defined above).</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">    </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;16&#39;</span>
<span class="w">    </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">        </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">            </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;2&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;3&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;4&#39;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">test_exp_{n_nodes}</span><span class="p p-Indicator">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
</pre></div>
</div>
<p>There are two notable aspects of this config file are:
1. <code class="docutils literal notranslate"><span class="pre">n_nodes</span></code> is a list of values
2. The experiment name references variable values.</p>
<p>All lists defined within any experiment namespace are required to be the same
length. They are zipped together, and iterated over to generate unique experiments.</p>
<p>In addition to accepting explicit lists, Ramble supports using
<a class="reference external" href="https://docs.python.org/3/library/functions.html#func-range">Python’s range() function</a>
to create a list. With this functionality, the example above could be re-written as:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">    </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;16&#39;</span>
<span class="w">    </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">        </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">            </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;range(1,</span><span class="nv"> </span><span class="s">5)&#39;</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">test_exp_{n_nodes}</span><span class="p p-Indicator">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
</pre></div>
</div>
</section>
<section id="variable-matrices">
<span id="ramble-matrix-logic"></span><h3>Variable Matrices<a class="headerlink" href="#variable-matrices" title="Link to this heading"></a></h3>
<p>In addition to allowing variables, Ramble’s config file has a special syntax for define variable matrices.</p>
<p>Matrices consume list variables, and generate a matrix of variables with it.
Each independent matrix performs the cross product of any list variables it
consumes.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">    </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">        </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">            </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;16&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;32&#39;</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;2&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;3&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;4&#39;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">test_exp_{n_nodes}_{processes_per_node}</span><span class="p p-Indicator">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">              </span><span class="nt">matrix</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processes_per_node</span>
</pre></div>
</div>
<p>In the above example, the <code class="docutils literal notranslate"><span class="pre">processes_per_node</span></code> variable is consumed as part
of a matrix. The result is a matrix of shape 1x2. After this matrix is
consumed, it will be crossed with the zipped vectors (creating 8 unique experiments).</p>
<p>Multiple matrices are allowed to be defined:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w"> </span><span class="nt">ramble</span><span class="p">:</span>
<span class="linenos"> 2</span><span class="w">   </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos"> 3</span><span class="w">     </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="linenos"> 4</span><span class="w">     </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="linenos"> 5</span><span class="w">     </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="nt">applications</span><span class="p">:</span>
<span class="linenos"> 7</span><span class="w">     </span><span class="nt">hostname</span><span class="p">:</span>
<span class="linenos"> 8</span><span class="w">       </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos"> 9</span><span class="w">         </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">10</span><span class="w">       </span><span class="nt">workloads</span><span class="p">:</span>
<span class="linenos">11</span><span class="w">         </span><span class="nt">serial</span><span class="p">:</span>
<span class="linenos">12</span><span class="w">           </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">13</span><span class="w">             </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;16&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;32&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">14</span><span class="w">             </span><span class="nt">partition</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;part1&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;part2&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">15</span><span class="w">             </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;2&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;3&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;4&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">16</span><span class="w">           </span><span class="nt">experiments</span><span class="p">:</span>
<span class="linenos">17</span><span class="w">             </span><span class="l l-Scalar l-Scalar-Plain">test_exp_{n_nodes}_{processes_per_node}</span><span class="p p-Indicator">:</span>
<span class="linenos">18</span><span class="w">               </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">19</span><span class="w">                 </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">20</span><span class="w">               </span><span class="nt">matrices</span><span class="p">:</span>
<span class="linenos">21</span><span class="w">               </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processes_per_node</span>
<span class="linenos">22</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">partition</span>
<span class="linenos">23</span><span class="w">               </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n_nodes</span>
</pre></div>
</div>
<p>The result of this is that two matrices are created. The first is a 2x2 matrix,
while the second is a 1x4 matrix. All matrices are required to have the same
number of elements, as they are flattened and zipped together. In this case,
there would be 4 experiments, each defined by a unique
<code class="docutils literal notranslate"><span class="pre">(processes_per_node,</span> <span class="pre">partition,</span> <span class="pre">n_nodes)</span></code> tuple.</p>
</section>
<section id="explicit-variable-zips">
<span id="ramble-explicit-zips"></span><h3>Explicit Variable Zips<a class="headerlink" href="#explicit-variable-zips" title="Link to this heading"></a></h3>
<p>A common pattern in python for iterating over multiple lists in lock-step is to
use something called a zip. For more information on how this behaves in
practice, see
<a class="reference external" href="https://docs.python.org/3.3/library/functions.html#zip">Python’s zip documentation</a>.</p>
<p>Ramble’s workspace config contains syntax for defining explicit variable zips.
These zips are named grouping of variables that are related and should be
iterated over together when generating experiments.</p>
<p>Zips consume list variables and generate a named grouping, which can be
consumed by matrices just as list variables would be.</p>
<p>Below is an example showing how to define explicit zips:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w"> </span><span class="nt">ramble</span><span class="p">:</span>
<span class="linenos"> 2</span><span class="w">   </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos"> 3</span><span class="w">     </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="linenos"> 4</span><span class="w">     </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="linenos"> 5</span><span class="w">     </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="nt">applications</span><span class="p">:</span>
<span class="linenos"> 7</span><span class="w">     </span><span class="nt">hostname</span><span class="p">:</span>
<span class="linenos"> 8</span><span class="w">       </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos"> 9</span><span class="w">         </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">10</span><span class="w">       </span><span class="nt">workloads</span><span class="p">:</span>
<span class="linenos">11</span><span class="w">         </span><span class="nt">serial</span><span class="p">:</span>
<span class="linenos">12</span><span class="w">           </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">13</span><span class="w">             </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;16&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;32&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">14</span><span class="w">             </span><span class="nt">partition</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;part1&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;part2&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">15</span><span class="w">             </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;2&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;3&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;4&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">16</span><span class="w">           </span><span class="nt">experiments</span><span class="p">:</span>
<span class="linenos">17</span><span class="w">             </span><span class="l l-Scalar l-Scalar-Plain">test_exp_{n_nodes}_{processes_per_node}</span><span class="p p-Indicator">:</span>
<span class="linenos">18</span><span class="w">               </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">19</span><span class="w">                 </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">20</span><span class="w">               </span><span class="nt">zips</span><span class="p">:</span>
<span class="linenos">21</span><span class="w">                 </span><span class="nt">partition_defs</span><span class="p">:</span>
<span class="linenos">22</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">partition</span>
<span class="linenos">23</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processes_per_node</span>
<span class="linenos">24</span><span class="w">               </span><span class="nt">matrix</span><span class="p">:</span>
<span class="linenos">25</span><span class="w">               </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">partition_defs</span>
<span class="linenos">26</span><span class="w">               </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n_nodes</span>
</pre></div>
</div>
<p>Which would result in eight experiments, crossing the <code class="docutils literal notranslate"><span class="pre">n_nodes</span></code> variable with
the zip of <code class="docutils literal notranslate"><span class="pre">partition</span></code> and <code class="docutils literal notranslate"><span class="pre">processes_per_node</span></code>.</p>
</section>
<section id="variant-control">
<span id="ramble-experiment-variants"></span><h3>Variant Control<a class="headerlink" href="#variant-control" title="Link to this heading"></a></h3>
<p>Within a workspace configuration file, experiments are able to define variants.
Variants are able to manipulate specific aspects of experiments and
applications. More information on these configuration options can be seen in
the <a class="reference internal" href="configuration_files.html#variants-config"><span class="std std-ref">Variants Configuration Section</span></a> documentation. To
begin with, the only variant that can be specific is the <code class="docutils literal notranslate"><span class="pre">package_manager</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">package_manager</span></code> variant is used to define which package manager is used
to configure and execute the experiments. To select <code class="docutils literal notranslate"><span class="pre">spack</span></code> as the package
manager, the following block can be added to any scope that variables can be
defined in.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">variants</span><span class="p">:</span>
<span class="w">  </span><span class="nt">package_manager</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spack</span>
</pre></div>
</div>
</section>
<section id="experiment-exclusion">
<span id="ramble-experiment-exclusion"></span><h3>Experiment Exclusion<a class="headerlink" href="#experiment-exclusion" title="Link to this heading"></a></h3>
<p>When writing a workspace configuration file, experiments can be explicitly
excluded from the generated set using an <code class="docutils literal notranslate"><span class="pre">exclude</span></code> block inside the
experiment definition. This block contains definitions of <code class="docutils literal notranslate"><span class="pre">variables</span></code>,
<code class="docutils literal notranslate"><span class="pre">matrices</span></code>, <code class="docutils literal notranslate"><span class="pre">zips</span></code>, and optional mathematical <code class="docutils literal notranslate"><span class="pre">where</span></code> statements to
define which experiments should be excluded from the generation process.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w"> </span><span class="nt">ramble</span><span class="p">:</span>
<span class="linenos"> 2</span><span class="w">   </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos"> 3</span><span class="w">     </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="linenos"> 4</span><span class="w">     </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="linenos"> 5</span><span class="w">     </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="nt">applications</span><span class="p">:</span>
<span class="linenos"> 7</span><span class="w">     </span><span class="nt">hostname</span><span class="p">:</span>
<span class="linenos"> 8</span><span class="w">       </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos"> 9</span><span class="w">         </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">10</span><span class="w">       </span><span class="nt">workloads</span><span class="p">:</span>
<span class="linenos">11</span><span class="w">         </span><span class="nt">serial</span><span class="p">:</span>
<span class="linenos">12</span><span class="w">           </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">13</span><span class="w">             </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;16&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;32&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">14</span><span class="w">             </span><span class="nt">partition</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;part1&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;part2&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">15</span><span class="w">             </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;2&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;3&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;4&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">16</span><span class="w">           </span><span class="nt">experiments</span><span class="p">:</span>
<span class="linenos">17</span><span class="w">             </span><span class="l l-Scalar l-Scalar-Plain">test_exp_{n_nodes}_{processes_per_node}</span><span class="p p-Indicator">:</span>
<span class="linenos">18</span><span class="w">               </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">19</span><span class="w">                 </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">20</span><span class="w">               </span><span class="nt">zips</span><span class="p">:</span>
<span class="linenos">21</span><span class="w">                 </span><span class="nt">partition_defs</span><span class="p">:</span>
<span class="linenos">22</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">partition</span>
<span class="linenos">23</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processes_per_node</span>
<span class="linenos">24</span><span class="w">               </span><span class="nt">matrices</span><span class="p">:</span>
<span class="linenos">25</span><span class="w">               </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">partition_defs</span>
<span class="linenos">26</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n_nodes</span>
<span class="linenos">27</span><span class="w">               </span><span class="nt">exclude</span><span class="p">:</span>
<span class="linenos">28</span><span class="w">                 </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">29</span><span class="w">                   </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;2&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;3&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">30</span><span class="w">                 </span><span class="nt">matrix</span><span class="p">:</span>
<span class="linenos">31</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">partition_defs</span>
<span class="linenos">32</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n_nodes</span>
</pre></div>
</div>
<p>In the example above, of the eight experiments that would be generated from the
experiment definition, four will be excluded. In the defined <code class="docutils literal notranslate"><span class="pre">exclude</span></code> block
experiments with <code class="docutils literal notranslate"><span class="pre">n_nodes</span> <span class="pre">=</span> <span class="pre">2</span></code> or <code class="docutils literal notranslate"><span class="pre">n_nodes</span> <span class="pre">=</span> <span class="pre">3</span></code> will be excluded from the
generation process.</p>
<p>This logic can be replicated in a <code class="docutils literal notranslate"><span class="pre">where</span></code> statement as well:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w"> </span><span class="nt">ramble</span><span class="p">:</span>
<span class="linenos"> 2</span><span class="w">   </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos"> 3</span><span class="w">     </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="linenos"> 4</span><span class="w">     </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="linenos"> 5</span><span class="w">     </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="nt">applications</span><span class="p">:</span>
<span class="linenos"> 7</span><span class="w">     </span><span class="nt">hostname</span><span class="p">:</span>
<span class="linenos"> 8</span><span class="w">       </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos"> 9</span><span class="w">         </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">10</span><span class="w">       </span><span class="nt">workloads</span><span class="p">:</span>
<span class="linenos">11</span><span class="w">         </span><span class="nt">serial</span><span class="p">:</span>
<span class="linenos">12</span><span class="w">           </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">13</span><span class="w">             </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;16&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;32&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">14</span><span class="w">             </span><span class="nt">partition</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;part1&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;part2&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">15</span><span class="w">             </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;2&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;3&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;4&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">16</span><span class="w">           </span><span class="nt">experiments</span><span class="p">:</span>
<span class="linenos">17</span><span class="w">             </span><span class="l l-Scalar l-Scalar-Plain">test_exp_{n_nodes}_{processes_per_node}</span><span class="p p-Indicator">:</span>
<span class="linenos">18</span><span class="w">               </span><span class="nt">variables</span><span class="p">:</span>
<span class="linenos">19</span><span class="w">                 </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="linenos">20</span><span class="w">               </span><span class="nt">zips</span><span class="p">:</span>
<span class="linenos">21</span><span class="w">                 </span><span class="nt">partition_defs</span><span class="p">:</span>
<span class="linenos">22</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">partition</span>
<span class="linenos">23</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processes_per_node</span>
<span class="linenos">24</span><span class="w">               </span><span class="nt">matrices</span><span class="p">:</span>
<span class="linenos">25</span><span class="w">               </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">partition_defs</span>
<span class="linenos">26</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n_nodes</span>
<span class="linenos">27</span><span class="w">               </span><span class="nt">exclude</span><span class="p">:</span>
<span class="linenos">28</span><span class="w">                 </span><span class="nt">where</span><span class="p">:</span>
<span class="linenos">29</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;{n_nodes}</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">2&#39;</span>
<span class="linenos">30</span><span class="w">                 </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;{n_nodes}</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">3&#39;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">where</span></code> statements can contain mathematical operations, but must result in a
boolean value. If any of the <code class="docutils literal notranslate"><span class="pre">where</span></code> statements evalaute to <code class="docutils literal notranslate"><span class="pre">True</span></code> within
an experiment, that experiment will be excluded from generation. To be more
explicit, all <code class="docutils literal notranslate"><span class="pre">where</span></code> statements are joined together with <code class="docutils literal notranslate"><span class="pre">or</span></code> operators.
Within any single <code class="docutils literal notranslate"><span class="pre">where</span></code> statement, operators can be joined together with
<code class="docutils literal notranslate"><span class="pre">and</span></code> and <code class="docutils literal notranslate"><span class="pre">or</span></code> operators as well.</p>
</section>
<section id="experiment-repeats">
<span id="ramble-experiment-repeats"></span><h3>Experiment Repeats<a class="headerlink" href="#experiment-repeats" title="Link to this heading"></a></h3>
<p>Ramble provides a simple mechanism to repeat the same experiment a specified number of
times, and calculates summary statistics for the set of repeated experiments. To enable
repeats, an <code class="docutils literal notranslate"><span class="pre">n_repeats</span></code> block can be added at the application, workload, or experiment
level.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">n_repeats</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span>
<span class="w">    </span><span class="nt">repeats_success_strict</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">True/False</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">n_repeats</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">n_repeats</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="nt">test_experiment</span><span class="p">:</span>
<span class="w">              </span><span class="nt">n_repeats</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span>
</pre></div>
</div>
<p>More information on setting repeats at the config level can be found in the
<a class="reference internal" href="configuration_files.html#experiment-repeats-config-option"><span class="std std-ref">configuration files</span></a> documentation.</p>
</section>
<section id="environment-variable-control">
<h3>Environment Variable Control<a class="headerlink" href="#environment-variable-control" title="Link to this heading"></a></h3>
<p>Environment variables can be controlled using an
<a class="reference internal" href="configuration_files.html#env-vars-config"><span class="std std-ref">env_var config section</span></a>,
defined at the appropriate level of the workspace config.</p>
<p>As a concrete example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">env_vars</span><span class="p">:</span>
<span class="w">  </span><span class="nt">set</span><span class="p">:</span>
<span class="w">    </span><span class="nt">SET_VAR</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">set_val</span>
<span class="w">  </span><span class="nt">append</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">var-separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;,&#39;</span>
<span class="w">    </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">      </span><span class="nt">APPEND_VAR</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app_val</span>
<span class="w">    </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="nt">PATH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app_path</span>
<span class="w">  </span><span class="nt">prepend</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="nt">PATH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prepend_path</span>
<span class="w">  </span><span class="nt">unset</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LD_LIBRARY_PATH</span>
</pre></div>
</div>
<p>Would result in roughly the following bash commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export SET_VAR=set_val</span>
<span class="go">export APPEND_VAR=$APPEND_VAR,app_val</span>
<span class="go">export PATH=prepend_path:$PATH:app_path</span>
<span class="go">unset LD_LIBRARY_PATH</span>
</pre></div>
</div>
</section>
<section id="templatized-workloads">
<h3>Templatized Workloads<a class="headerlink" href="#templatized-workloads" title="Link to this heading"></a></h3>
<p>As previously shown, variables can be defined using lists or matrices. In addition to
controlling several aspects of experiments, list and matrix variables can be used to
replicate an experiment across workloads.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">        </span><span class="nt">application_workloads</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;parallel&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;serial&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;local&#39;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="s">&#39;{application_workloads}&#39;</span><span class="p p-Indicator">:</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="nt">test_exp</span><span class="p">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
</pre></div>
</div>
<p>In the above example, we use the <code class="docutils literal notranslate"><span class="pre">application_workloads</span></code> variable to define
the names of the workloads we’d like to generate experiments for. Any variable
can be used to define the name of the workloads, except those reserved by
Ramble. These can be seen in the <a class="reference internal" href="#ramble-reserved-variables"><span class="std std-ref">Reserved Variables</span></a> section.</p>
</section>
<section id="cross-experiment-variable-references">
<h3>Cross Experiment Variable References<a class="headerlink" href="#cross-experiment-variable-references" title="Link to this heading"></a></h3>
<p>Variables can be defined to pull the value of a variable out of a different
experiment. This is particularly useful when an experiment needs the path to
something ramble automatically generates in a different experiment.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">    </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;16&#39;</span>
<span class="w">    </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">        </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">            </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="nt">test_exp1</span><span class="p">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">                </span><span class="nt">real_value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;exp1_value&#39;</span>
<span class="w">            </span><span class="nt">test_exp2</span><span class="p">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">                </span><span class="nt">test_value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">real_value in hostname.serial.test_exp1</span>
</pre></div>
</div>
<p>In the above example, <code class="docutils literal notranslate"><span class="pre">test_value</span></code> extracts the value of <code class="docutils literal notranslate"><span class="pre">real_value</span></code> as
defined in the experiment <code class="docutils literal notranslate"><span class="pre">hostname.serial.test_exp1</span></code>. When evaluated, this
will set <code class="docutils literal notranslate"><span class="pre">test_value</span></code> to <code class="docutils literal notranslate"><span class="pre">'exp1_value'</span></code>.</p>
</section>
<section id="experiment-modifiers">
<h3>Experiment Modifiers<a class="headerlink" href="#experiment-modifiers" title="Link to this heading"></a></h3>
<p>In addition to containing application definitions, Ramble also provides
experiment modifiers. Experiment modifiers encapsulate several aspects of a
standard modification to an experiment, such as prepending a binary with a tool
or profiler, and can be applied to experiments to modify their behavior.</p>
<p>Available experiment modifiers can be seen using <code class="docutils literal notranslate"><span class="pre">ramble</span> <span class="pre">mods</span> <span class="pre">list</span></code>, and more
information about a particular modifier can be see with
<code class="docutils literal notranslate"><span class="pre">ramble</span> <span class="pre">mods</span> <span class="pre">info</span> <span class="pre">&lt;mod_name&gt;</span></code>.</p>
<p>Modifiers can be applied to experiments using the following YAML syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">    </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;16&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">gromacs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">water_bare</span><span class="p">:</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="nt">test_exp1</span><span class="p">:</span>
<span class="w">              </span><span class="nt">modifiers</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">intel-aps</span>
<span class="w">                </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mpi</span>
<span class="w">                </span><span class="nt">on_executable</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
</pre></div>
</div>
<p>Modifiers can be defined at any level variables can be defined at (and are even
their own config section).</p>
<p>When defining a modifier, the <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute is the name of the modifier
that will be applied. The <code class="docutils literal notranslate"><span class="pre">mode</span></code> attribute is a modifier specific setting
allowing the user to select the modifier behavior. Modes can be seen by looking
at the modifier information, and represent modes of use for the modifier. Modes
group several general aspects of a modifier into one usage mode, and can allow
a general modifier to present many operational entry points. The
<code class="docutils literal notranslate"><span class="pre">on_executable</span></code> attribute is a list of experiment executables that the
modifier should be applied to. These executable names are matched using
python’s <code class="docutils literal notranslate"><span class="pre">fnmatch.fnmatch</span></code> functionality.</p>
<p>If it is not set, modifiers will attempt to determine their own <code class="docutils literal notranslate"><span class="pre">mode</span></code>
attribute. This will succeed if the modifier has a single mode of operation. If
there are multiple modes, this will raise an exception.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">on_executable</span></code> attribute is not set, it will default to <code class="docutils literal notranslate"><span class="pre">'*'</span></code> which
will match all executables. Modifier classes can (and should) be implemented to
only act on the correct executable types (i.e. executables with <code class="docutils literal notranslate"><span class="pre">use_mpi=true</span></code>).</p>
</section>
<section id="experiment-tags">
<span id="id3"></span><h3>Experiment Tags<a class="headerlink" href="#experiment-tags" title="Link to this heading"></a></h3>
<p>While applications and workloads can be tagged within an application definition
file (using the <code class="docutils literal notranslate"><span class="pre">tags()</span></code> or <code class="docutils literal notranslate"><span class="pre">workload()</span></code> directives), workloads and
experiments can also be tagged within a workspace configuration file. This
allows users to define their own tags to communicate what an experiment and
workload might be used for beyond the information captured in the application
definition file.</p>
<p>The below example shows how tags can be defined within a workspace:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">      </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">      </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;16&#39;</span>
<span class="w">    </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">      </span><span class="nt">gromacs</span><span class="p">:</span>
<span class="w">        </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">          </span><span class="nt">water_bare</span><span class="p">:</span>
<span class="w">            </span><span class="nt">tags</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wltag</span>
<span class="w">            </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">              </span><span class="nt">test_exp1</span><span class="p">:</span>
<span class="w">                </span><span class="nt">tags</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag1</span>
<span class="w">                </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span><span class="w"> </span>
<span class="w">              </span><span class="nt">test_exp2</span><span class="p">:</span>
<span class="w">                </span><span class="nt">tags</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag2</span>
<span class="w">                </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span><span class="w"> </span>
</pre></div>
</div>
<p>In the above example, all experiments are tagged with the <code class="docutils literal notranslate"><span class="pre">wltag</span></code> tag. Only
the <code class="docutils literal notranslate"><span class="pre">test_exp1</span></code> experiment is tagged with the <code class="docutils literal notranslate"><span class="pre">tag1</span></code> tag, while the
<code class="docutils literal notranslate"><span class="pre">test_exp2</span></code> experiment is tagged with the <code class="docutils literal notranslate"><span class="pre">tag2</span></code> tag.</p>
<p>These tags are propagated into a workspace’s results file, and can be used to
filter pipeline commands, as show in the
<a class="reference internal" href="workspace.html#filter-experiments"><span class="std std-ref">filtering experiments documentation</span></a>.</p>
</section>
<section id="controlling-internals">
<span id="workspace-internals"></span><h3>Controlling Internals<a class="headerlink" href="#controlling-internals" title="Link to this heading"></a></h3>
<p>Within a workspace config, an internals dictionary can be used to control
several internal aspects of the application, workload, and experiment.</p>
<p>This config section is defined in the
<a class="reference internal" href="configuration_files.html#internals-config"><span class="std std-ref">internals config section</span></a>.</p>
<p>Below are examples of using this within a workspace config file.</p>
<p>Custom executables can be created within the internals dictionary. Below is an
example, showing how to create a <code class="docutils literal notranslate"><span class="pre">lscpu</span></code> executable at the application level.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">internals</span><span class="p">:</span>
<span class="w">        </span><span class="nt">custom_executables</span><span class="p">:</span>
<span class="w">          </span><span class="nt">lscpu</span><span class="p">:</span>
<span class="w">            </span><span class="nt">template</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;lscpu&#39;</span>
<span class="w">            </span><span class="nt">use_mpi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">            </span><span class="nt">redirect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{log_file}&#39;</span>
<span class="w">    </span><span class="w w-Error"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<p>The above example creates a custom executable, named <code class="docutils literal notranslate"><span class="pre">lscpu</span></code> that will inject
the command <code class="docutils literal notranslate"><span class="pre">lscpu</span></code> into the command for an experiment when it is used. It is
important to note that this only creates the executable, and does not use it.</p>
<p>The internals dictionary allows the ability to control the order pre-defined
executables (or custom executables) are pieced together to build an experiment.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">internals</span><span class="p">:</span>
<span class="w">        </span><span class="nt">custom_executables</span><span class="p">:</span>
<span class="w">          </span><span class="nt">lscpu</span><span class="p">:</span>
<span class="w">            </span><span class="nt">template</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;lscpu&#39;</span>
<span class="w">            </span><span class="nt">use_mpi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">            </span><span class="nt">redirect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{log_file}&#39;</span>
<span class="w">        </span><span class="nt">executables</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">serial</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">builtin::env_vars</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lscpu</span>
</pre></div>
</div>
<p>The above example builds off of the custom executable example, and shows how
one can control the order of the executables in the formatted executable expansions.</p>
<p>The default for the hostname application is <code class="docutils literal notranslate"><span class="pre">[builtin::env_vars,</span>
<span class="pre">serial/parallel]</span></code> but this changes the order and injects <code class="docutils literal notranslate"><span class="pre">lscpu</span></code> into the
expansion.</p>
<p>Executable order can also be controlled via the <code class="docutils literal notranslate"><span class="pre">executable_injection</span></code> block
within the <code class="docutils literal notranslate"><span class="pre">internals</span></code> block. Injecting the <code class="docutils literal notranslate"><span class="pre">lscpu</span></code> executable to the end of
the list of executables can be performed with the following:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">internals</span><span class="p">:</span>
<span class="w">        </span><span class="nt">custom_executables</span><span class="p">:</span>
<span class="w">          </span><span class="nt">lscpu</span><span class="p">:</span>
<span class="w">            </span><span class="nt">template</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;lscpu&#39;</span>
<span class="w">            </span><span class="nt">use_mpi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">            </span><span class="nt">redirect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{log_file}&#39;</span>
<span class="w">        </span><span class="nt">executable_injection</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lscpu</span>
</pre></div>
</div>
<p>This is a generic way to add the <code class="docutils literal notranslate"><span class="pre">lscpu</span></code> custom executable to the end of the
list of executables for the experiment. For more information on this see the
<a class="reference internal" href="configuration_files.html#internals-config"><span class="std std-ref">internals config section</span></a> documentation.</p>
<p>When defining custom executables, sometimes it’s useful to be able to override
specific variable definitions for only this executable definition. As an
example, consider running a command to get information from every node in a job
allocation. While the actual experiment might be utilizing many processes on
each compute node, the custom executable only wants to run a single process on
each compute node. Ramble provides the ability for users to define variables
that are scoped to only the custom executable instead of the entire experiment.
Consider the following example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">gromacs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">internals</span><span class="p">:</span>
<span class="w">        </span><span class="nt">custom_executables</span><span class="p">:</span>
<span class="w">          </span><span class="nt">all_hosts</span><span class="p">:</span>
<span class="w">            </span><span class="nt">template</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;hostname&#39;</span>
<span class="w">            </span><span class="nt">use_mpi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">            </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">              </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}&#39;</span>
<span class="w">              </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">            </span><span class="nt">redirect</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{log_file}&#39;</span>
</pre></div>
</div>
<p>In this example, a custom executable named <code class="docutils literal notranslate"><span class="pre">all_hosts</span></code> is defined. Within
this executable, the value of <code class="docutils literal notranslate"><span class="pre">n_ranks</span></code> is defined to be the value of
<code class="docutils literal notranslate"><span class="pre">n_nodes</span></code>, and <code class="docutils literal notranslate"><span class="pre">processes_per_node</span></code> is defined to be <code class="docutils literal notranslate"><span class="pre">1</span></code>, causing only
one rank per compute node. This would print the hostname of each node in the
experiment once.</p>
</section>
<section id="reserved-variables">
<span id="ramble-reserved-variables"></span><h3>Reserved Variables<a class="headerlink" href="#reserved-variables" title="Link to this heading"></a></h3>
<p>There are several reserved, auto-generated, and required variables for Ramble
to function properly. This section will describe them.</p>
<p>Ramble requires the following variables to be defined:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n_ranks</span></code> - Defines the number of MPI ranks to use. If not explicitly set,
is defined as: <code class="docutils literal notranslate"><span class="pre">{processes_per_node}*{n_nodes}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_nodes</span></code> - Defines the number of machines needed for the experiment. If
not explicitly set, is defined as:
<code class="docutils literal notranslate"><span class="pre">ceiling({n_ranks}/{processes_per_node})</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">processes_per_node</span></code> - Defines how many ranks should be on each node. If
not explicitly set, is defined as: <code class="docutils literal notranslate"><span class="pre">ceiling({n_ranks}/{n_nodes})</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mpi_command</span></code> - Template for generating an MPI command</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">batch_submit</span></code> - Template for generating a batch system submit command</p></li>
</ul>
<p>Ramble automatically generates definitions for the following variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">application_name</span></code> - Set to the name of the application</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">workload_name</span></code> - Set to the name of the workload within the application</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">experiment_name</span></code> - Set to the name of the experiment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">env_name</span></code> - By default defined as <code class="docutils literal notranslate"><span class="pre">{application_name}</span></code>. Can be
overridden to control the software environment to use.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">application_run_dir</span></code> - Absolute path to
<code class="docutils literal notranslate"><span class="pre">$workspace_root/experiments/{application_name}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">workload_run_dir</span></code> - Absolute path to
<code class="docutils literal notranslate"><span class="pre">$workspace_root/experiments/{application_name}/{workload_name}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">experiment_run_dir</span></code> - Absolute path to
<code class="docutils literal notranslate"><span class="pre">$workspace_root/experiments/{application_name}/{workload_name}/{experiment_name}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">application_input_dir</span></code> - Absolute path to
<code class="docutils literal notranslate"><span class="pre">$workspace_root/inputs/{application_name}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">workload_input_dir</span></code> - Absolute path to
<code class="docutils literal notranslate"><span class="pre">$workspace_root/inputs/{application_name}/{workload_name}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">experiment_index</span></code> - Index, in set, of experiment. If part of a chain,
shares a value with its root.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">env_path</span></code> - Absolute path to
<code class="docutils literal notranslate"><span class="pre">$workspace_root/software/{env_name}.{workload_name}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_dir</span></code> - Absolute path to <code class="docutils literal notranslate"><span class="pre">$workspace_root/logs</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_file</span></code> - Absolute path to
<code class="docutils literal notranslate"><span class="pre">{experiment_run_dir}/{experiment_name}.out</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;input_name&gt;</span></code> - Applications that have input files have variables defined
that contain the absolute path to:
<code class="docutils literal notranslate"><span class="pre">$workspace_root/inputs/{application_name}/{workload_name}/&lt;input_name&gt;</span></code>
where <code class="docutils literal notranslate"><span class="pre">&lt;input_name&gt;</span></code> is the name as defined in the <code class="docutils literal notranslate"><span class="pre">input_file</span></code>
directive.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;template_name&gt;</span></code> - Any files with the <code class="docutils literal notranslate"><span class="pre">.tpl</span></code> extension in
<code class="docutils literal notranslate"><span class="pre">$workspace_root/configs</span></code> have a variable generated that resolves to the
absolute path to: <code class="docutils literal notranslate"><span class="pre">{experiment_run_dir}/&lt;template_name&gt;</span></code> where
<code class="docutils literal notranslate"><span class="pre">&lt;template_name&gt;</span></code> is the filename of the template, without the extension.</p></li>
</ul>
<p>Ramble also generates or requires the following variables, depending on the
package manager used:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;software_spec_name&gt;_path</span></code> - Set to the installation location for the package
for all packages defined in an experiment’s environment definition.
<code class="docutils literal notranslate"><span class="pre">&lt;software_spec_name&gt;</span></code> is the name of the package as defined in the
<code class="docutils literal notranslate"><span class="pre">software:packages</span></code> dictionary.</p></li>
</ul>
<p>When the package manager is <code class="docutils literal notranslate"><span class="pre">spack</span></code> this is the equivalent to the output of
<code class="docutils literal notranslate"><span class="pre">spack</span> <span class="pre">location</span> <span class="pre">-i</span></code> for each install spec.</p>
<p>Any applications that have required packages require path variables to be
defined when a package manager is not used.</p>
<p>As an example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variants</span><span class="p">:</span>
<span class="w">    </span><span class="nt">package_manager</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spack</span>
<span class="w">  </span><span class="nt">software</span><span class="p">:</span>
<span class="w">    </span><span class="nt">packages</span><span class="p">:</span>
<span class="w">      </span><span class="nt">grm</span><span class="p">:</span>
<span class="w">        </span><span class="nt">pkg_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gromacs@2023.1</span>
<span class="w">    </span><span class="nt">environments</span><span class="p">:</span>
<span class="w">      </span><span class="nt">grm_env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">packages</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grm</span>
</pre></div>
</div>
<p>Defines a software environment named <code class="docutils literal notranslate"><span class="pre">grm_env</span></code>. The default environment used
has the same name as the application the experiment is generated from. In
experiments which use this <code class="docutils literal notranslate"><span class="pre">grm_env</span></code> environment, a variable is defined
named: <code class="docutils literal notranslate"><span class="pre">gromacs</span></code>, as that is the package named defined by the <code class="docutils literal notranslate"><span class="pre">pkg_spec</span></code>
attribute of the <code class="docutils literal notranslate"><span class="pre">grm</span></code> package definition. This variable contains the path to
the installation location for the <code class="docutils literal notranslate"><span class="pre">gromacs</span></code> package.</p>
<p><strong>NOTE</strong>: Package installation location variables are only generated when
actually performing the setup of a workspace. When a <code class="docutils literal notranslate"><span class="pre">--dry-run</span></code> is
performed, these paths are not populated.</p>
</section>
</section>
<section id="software-dictionary">
<h2>Software Dictionary<a class="headerlink" href="#software-dictionary" title="Link to this heading"></a></h2>
<p>Within a ramble.yaml file, the <code class="docutils literal notranslate"><span class="pre">software:</span></code> dictionary controls the software
stack installation that ramble performs. This configuration section is defined
in the <a class="reference internal" href="configuration_files.html#software-config"><span class="std std-ref">Software section</span></a> documentation.
a packages dictionary, and an environments dictionary.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ramble</span> <span class="pre">workspace</span> <span class="pre">concretize</span></code> command can help construct a functional
software dictionary based on the experiments listed.</p>
<p>It is important to note that packages and environments that are not used by an
experiment are not installed.</p>
<p>Application definition files can define one or more <code class="docutils literal notranslate"><span class="pre">software_spec</span></code>
directives, which are packages the application might need to run properly.
Additionally, packages can be marked as required through the
<code class="docutils literal notranslate"><span class="pre">required_package</span></code> directive.</p>
</section>
<section id="controlling-mpi-libraries-and-batch-systems">
<h2>Controlling MPI Libraries and Batch Systems<a class="headerlink" href="#controlling-mpi-libraries-and-batch-systems" title="Link to this heading"></a></h2>
<p>Some workspaces might be configured with the goal of exploring the performance
of different MPI libraries (e.g. MPICH vs. Open MPI), or of performing the same
experiment in multiple batch schedulers (e.g. SLURM, PBS Pro, and Flux).</p>
<p>This section will show how to perform these experiments within a workspace
configuration file.</p>
<section id="mpi-command-control">
<h3>MPI Command Control<a class="headerlink" href="#mpi-command-control" title="Link to this heading"></a></h3>
<p>When writing a ramble configuration file to perform the same experiment with
different MPI libraries, the MPI section within the Ramble dictionary is
insufficient for changing the flags used based on the MPI library used.</p>
<p>However, Ramble’s variable definitions can be used to control this on a
per-experiment basis.</p>
<p>Below is an example of running a Gromacs experiment in both MPICH and OpenMPI:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variants</span><span class="p">:</span>
<span class="w">    </span><span class="nt">package_manager</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spack</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}</span><span class="nv"> </span><span class="s">-ppn</span><span class="nv"> </span><span class="s">{processes_per_node}</span><span class="nv"> </span><span class="s">&#39;</span><span class="w"> </span><span class="c1"># MPICH</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}</span><span class="nv"> </span><span class="s">-nperhost</span><span class="nv"> </span><span class="s">{processes_per_node}</span><span class="nv"> </span><span class="s">&#39;</span><span class="w"> </span><span class="c1"># OpenMPI</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">gromacs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">water_bare</span><span class="p">:</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="s">&#39;{env_name}&#39;</span><span class="p p-Indicator">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">                </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">                </span><span class="nt">env_name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;gromacs-mpich&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gromacs-ompi&#39;</span><span class="p p-Indicator">]</span>
<span class="nt">software</span><span class="p">:</span>
<span class="w">  </span><span class="nt">packages</span><span class="p">:</span>
<span class="w">    </span><span class="nt">gcc9</span><span class="p">:</span>
<span class="w">      </span><span class="nt">pkg_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc@9.3.0 target=x86_64</span>
<span class="w">    </span><span class="nt">mpich</span><span class="p">:</span>
<span class="w">      </span><span class="nt">pkg_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mpich@4.0.2 target=x86_64</span>
<span class="w">      </span><span class="nt">compiler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc9</span>
<span class="w">    </span><span class="nt">ompi</span><span class="p">:</span>
<span class="w">      </span><span class="nt">pkg_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openmpi@4.1.4 target=x86_64</span>
<span class="w">      </span><span class="nt">compiler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc9</span>
<span class="w">    </span><span class="nt">gromacs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">pkg_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gromacs@2022.4</span>
<span class="w">      </span><span class="nt">compiler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc9</span>
<span class="w">  </span><span class="nt">environments</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">gromacs-{mpi}</span><span class="p p-Indicator">:</span>
<span class="w">      </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">        </span><span class="nt">mpi</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;mpich&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ompi&#39;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">packages</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gromacs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;{mpi}&#39;</span>
</pre></div>
</div>
<p>In the above example, you can see how <code class="docutils literal notranslate"><span class="pre">env_name</span></code> is used to test both an
OpenMPI and MPICH version of Gromacs. Additionally, the <code class="docutils literal notranslate"><span class="pre">mpi_command</span></code>
variable is used to define how <code class="docutils literal notranslate"><span class="pre">mpirun</span></code> should look for each of the MPI
libraries.</p>
<p>Using the previously described Ramble vector syntax, this configuration file
will generate 2 experiments. Both <code class="docutils literal notranslate"><span class="pre">env_name</span></code> and <code class="docutils literal notranslate"><span class="pre">mpi_command</span></code> will be
zipped together, giving each experiment a tuple of: <code class="docutils literal notranslate"><span class="pre">(mpi_command,</span>
<span class="pre">env_name)</span></code> which allows us to pair a specific MPI command to the
corresponding Gromacs spec.</p>
</section>
<section id="batch-system-control">
<h3>Batch System Control<a class="headerlink" href="#batch-system-control" title="Link to this heading"></a></h3>
<p>Similar to the previously describe MPI command control, experiments can use
different batch systems by overriding the <code class="docutils literal notranslate"><span class="pre">batch_submit</span></code> variable.</p>
<p>Below is an example configuration file showing how the <code class="docutils literal notranslate"><span class="pre">batch_submit</span></code>
variable can be used to submit the same experiment to multiple batch systems.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variants</span><span class="p">:</span>
<span class="w">    </span><span class="nt">package_manager</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spack</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}</span><span class="nv"> </span><span class="s">-ppn</span><span class="nv"> </span><span class="s">{processes_per_node}&#39;</span>
<span class="w">    </span><span class="nt">batch_system</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slurm</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pbs</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;sbatch</span><span class="nv"> </span><span class="s">{execute_slurm}&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;qsub</span><span class="nv"> </span><span class="s">{execute_pbs}&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">gromacs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">water_bare</span><span class="p">:</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="s">&#39;{batch_system}&#39;</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">                </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="nt">software</span><span class="p">:</span>
<span class="w">  </span><span class="nt">packages</span><span class="p">:</span>
<span class="w">    </span><span class="nt">gcc9</span><span class="p">:</span>
<span class="w">      </span><span class="nt">pkg_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc@9.3.0 target=x86_64</span>
<span class="w">    </span><span class="nt">impi2021</span><span class="p">:</span>
<span class="w">      </span><span class="nt">pkg_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">intel-oneapi-mpi@2021.11.0 target=x86_64</span>
<span class="w">      </span><span class="nt">compiler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc9</span>
<span class="w">    </span><span class="nt">gromacs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">pkg_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gromacs@2022.4</span>
<span class="w">      </span><span class="nt">compiler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcc9</span>
<span class="w">  </span><span class="nt">environments</span><span class="p">:</span>
<span class="w">    </span><span class="nt">gromacs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">packages</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">impi2021</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gromacs</span>
</pre></div>
</div>
<p>The above example overrides the generated <code class="docutils literal notranslate"><span class="pre">batch_submit</span></code> variable to change
how different experiments are submitted. In this example, we submit the same
experiment to both SLURM and PBS.</p>
<p>Note that each of the two <code class="docutils literal notranslate"><span class="pre">batch_submit</span></code> commands submits a different
template. This means the workspace’s configs directory should have two files:
<code class="docutils literal notranslate"><span class="pre">execute_slurm.tpl</span></code> and <code class="docutils literal notranslate"><span class="pre">execute_pbs.tpl</span></code> which will be template submission
scripts to each of the batch systems.</p>
</section>
</section>
<section id="experiment-chains">
<h2>Experiment Chains<a class="headerlink" href="#experiment-chains" title="Link to this heading"></a></h2>
<p>Multiple experiments can be executed within the same context by a process known
as chaining, this allows multiple experiments (potentially from multiple
applications) to be executed in the same context and is useful for many
potential use cases such as running multiple experiments on the same physical
hardware</p>
<p>There are two important parts for defining an experiment chain. The first of
these is simply defining the experiment chain, and the second is defining
experiments which are only intended to be used when chained into another
experiment, known as template experiments.</p>
<section id="defining-experiment-chains">
<h3>Defining Experiment Chains<a class="headerlink" href="#defining-experiment-chains" title="Link to this heading"></a></h3>
<p>The following example shows how to specify a chain of experiments:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">    </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;16&#39;</span>
<span class="w">    </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">        </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">            </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="nt">test_exp1</span><span class="p">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">            </span><span class="nt">test_exp2</span><span class="p">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">              </span><span class="nt">chained_experiments</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hostname.serial.test_exp1</span>
<span class="w">                </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">                </span><span class="nt">order</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;after_chain&#39;</span>
<span class="w">                </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;2&#39;</span>
</pre></div>
</div>
<p>In the above example, the <code class="docutils literal notranslate"><span class="pre">hostname.serial.test_exp2</span></code> experiment defines an
experiment chain. The chain is defined by mergining the <code class="docutils literal notranslate"><span class="pre">chained_experiments</span></code>
dictionaries and inserting itself at the appropriate location.</p>
<p>Experiments can be defined with in the <code class="docutils literal notranslate"><span class="pre">chained_experiments</span></code> dictionary using
the following format:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">chained_experiments</span><span class="p">:</span><span class="w"> </span><span class="c1"># List of experiments to chain</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Fully qualified experiment namespace</span>
<span class="w">  </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Command that executes the sub experiment</span>
<span class="w">  </span><span class="nt">order</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Order to chain this experiment. Defaults to &#39;after_root&#39;</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Variables dictionary to override the variables from the</span>
<span class="w">             </span><span class="l l-Scalar l-Scalar-Plain">original experiment</span>
</pre></div>
</div>
<p>Each chained experiment receives its own unique namespace. These take the form of:
<code class="docutils literal notranslate"><span class="pre">&lt;parent_experiment_namespace&gt;.chain.&lt;chain_index&gt;.&lt;chained_experiment_namespace&gt;</span></code></p>
<p>In the above example, the chained experiment would have a namespace of:
<code class="docutils literal notranslate"><span class="pre">hostname.serial.test_exp2.chain.0.hostname.serial.test_exp1</span></code></p>
<p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute can use <cite>globbing
syntax&lt;https://docs.python.org/3/library/fnmatch.html#module-fnmatch&gt;</cite> to chain
multiple experiments at once.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">order</span></code> keyword is optional. Valid options include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">before_chain</span></code> Chained experiment is injected at the beginning of the chain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">before_root</span></code> Chained experiment is injected right before the root experiment in the chain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">after_root</span></code> Chained experiment is injected right after the root experiment in the chain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">after_chain</span></code> Chained experiment is injected at the end of the chain</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">root</span></code> experiment is defined as the initial experiment that started the
chain. When examining the entire chain, the root experiment is the only one
that does not have <code class="docutils literal notranslate"><span class="pre">chain.{idx}</span></code> in its name.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">variables</span></code> keyword is optional. It can be used to override the
definition of variables from the chained experiment if needed.</p>
<p>Once the experiments are defined, the final order of the chain can be viewed using
<code class="docutils literal notranslate"><span class="pre">ramble</span> <span class="pre">workspace</span> <span class="pre">info</span> <span class="pre">-vvv</span></code>.</p>
<p><strong>NOTE</strong> When using the <code class="docutils literal notranslate"><span class="pre">experiment_index</span></code> variable, all experiments in a
chain share the same value. This ensures the resulting experiment will be
complete when executed.</p>
</section>
<section id="suppressing-experiments">
<h3>Suppressing Experiments<a class="headerlink" href="#suppressing-experiments" title="Link to this heading"></a></h3>
<p>The below example shows how to suppress generation of an experiment, by marking
it as a template.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">    </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;16&#39;</span>
<span class="w">    </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">        </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">            </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="nt">test_exp1</span><span class="p">:</span>
<span class="w">              </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">            </span><span class="nt">test_exp2</span><span class="p">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">              </span><span class="nt">chained_experiments</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hostname.serial.test_exp1</span>
<span class="w">                </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">                </span><span class="nt">order</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;after_chain&#39;</span>
<span class="w">                </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;2&#39;</span>
</pre></div>
</div>
<p>In the above example, the <code class="docutils literal notranslate"><span class="pre">template</span></code> keyword is used to mark
<code class="docutils literal notranslate"><span class="pre">hostname.serial.test_exp1</span></code> as a template experiment. This prevents it from
being used as a stand-alone experiment, but it will still be generated and used
when it’s chained into other experiments.</p>
</section>
<section id="variable-inheritance">
<h3>Variable Inheritance<a class="headerlink" href="#variable-inheritance" title="Link to this heading"></a></h3>
<p>In some cases, it’s useful for an experiment to take values for its variables
from the root of the chain. For example, if an allreduce benchmark should be
run on all of the nodes within a job before the actual experiment begins, but
the number of nodes changes based on the root experiment. In this case, a
workspace might be more simply defined if the root experiment can inject its
own definition for the number of nodes into the chained experiments. To
accomplish this, the: <code class="docutils literal notranslate"><span class="pre">inherit_variables</span></code> attribute within a chained
experiment definition can be used to define which variables should be inherited
from the root experiment.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">    </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;16&#39;</span>
<span class="w">    </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">        </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">            </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="nt">test_exp1</span><span class="p">:</span>
<span class="w">              </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">            </span><span class="nt">test_exp2</span><span class="p">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;4&#39;</span>
<span class="w">              </span><span class="nt">chained_experiments</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hostname.serial.test_exp1</span>
<span class="w">                </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">                </span><span class="nt">order</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;after_chain&#39;</span>
<span class="w">                </span><span class="nt">inherit_variables</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n_ranks</span>
</pre></div>
</div>
<p>In the example above, the <code class="docutils literal notranslate"><span class="pre">hostname.serial.test_exp2</span></code> experiment represents
the root of the experiment chain. The <code class="docutils literal notranslate"><span class="pre">inherit_variables</span></code> list will cause
this root experiment to inject its own value for <code class="docutils literal notranslate"><span class="pre">n_nodes</span></code> into the chained
experiment, overriding its explicitly defined value in the experiment
definition.</p>
</section>
<section id="defining-chains-of-chains">
<h3>Defining Chains of Chains<a class="headerlink" href="#defining-chains-of-chains" title="Link to this heading"></a></h3>
<p>Ramble supports the ability to define chains of experiment chains. This allows
an experiment to automatically implicitly include all of the experiments chained
into the explicitly chained experiment.</p>
<p>Below is an example showing how chains of chains can be defined:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ramble</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mpi_command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mpirun</span><span class="nv"> </span><span class="s">-n</span><span class="nv"> </span><span class="s">{n_ranks}&#39;</span>
<span class="w">    </span><span class="nt">batch_submit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">    </span><span class="nt">processes_per_node</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;16&#39;</span>
<span class="w">    </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{n_nodes}*{processes_per_node}&#39;</span>
<span class="w">  </span><span class="nt">applications</span><span class="p">:</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span>
<span class="w">      </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">        </span><span class="nt">n_threads</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">      </span><span class="nt">workloads</span><span class="p">:</span>
<span class="w">        </span><span class="nt">serial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">            </span><span class="nt">n_nodes</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">          </span><span class="nt">experiments</span><span class="p">:</span>
<span class="w">            </span><span class="nt">child_level2_experiment</span><span class="p">:</span>
<span class="w">              </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">            </span><span class="nt">child_level1_experiment</span><span class="p">:</span>
<span class="w">              </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">              </span><span class="nt">chained_experiments</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hostname.serial.child_level2_experiment</span>
<span class="w">                </span><span class="nt">order</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;before_root&#39;</span>
<span class="w">                </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
<span class="w">            </span><span class="nt">parent_experiment</span><span class="p">:</span>
<span class="w">              </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">                </span><span class="nt">n_ranks</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">              </span><span class="nt">chained_experiments</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hostname.serial.child_level1_experiment</span>
<span class="w">                </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{execute_experiment}&#39;</span>
</pre></div>
</div>
<p>In the above example, the resulting experiment chain would be:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hostname.serial.parent_experiment.chain.0.hostname.serial.child_level2_experiment</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hostname.serial.parent_experiment</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hostname.serial.parent_experiment.chain.1.hostname.serial.child_level1_experiment</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="workspace.html" class="btn btn-neutral float-left" title="Ramble Workspace" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="success_criteria.html" class="btn btn-neutral float-right" title="Success Criteria" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Google LLC.
      <span class="lastupdated">Last updated on Jul 15, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>